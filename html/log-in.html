<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/log-in.css">
    <link href="Pictures/favicon-32x32.png" rel="icon" type="image/x-icon" />
</head>
<body>
    <!-- header started -->
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <div id="container">
        <!-- Header part till slideshow -->
        <div id="top-header">
            <div id="above-nav">
                <img src="../Pictures/jordan.png" alt="">
                <a style="color: black; text-decoration: none; padding-top: 4px;" href="index.html">Home</a>
                <p>|</p>
                <a style="color:black; text-decoration:none;" href="help.html">
                    <p>Help</p>
                </a>
                <p>|</p>
                <a style="color:black; text-decoration:none;" href="join.html">
                    <p>Join us</p>
                </a>
                <p>|</p>
                <a style="color:black; text-decoration:none;" href="log-in.html">
                    <p>Sign in</p>
                </a>
            </div>

            <nav>
                <img src="../Pictures/nike-logo.png" class="logo">
                <div id="nav-text">
                    <p>Men</p>
                    <a href="womens.html" style="text-decoration:none; color:black;">
                        <p>Women</p>
                    </a>
                    <p>Kids</p>
                </div>
                <ul>
                    <li>
                        <ion-icon name="search-outline" class="search-icon"></ion-icon>
                    </li>
                    <li>
                        <a style="color:black; text-decoration:none;" href="bag.html">
                            <ion-icon name="bag-outline" class="bag-icon"></ion-icon>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <div class="container1">
            <div class="card">
                <div class="inner-box">
                    <div class="card-front">
                        <img id="logo" src="../Pictures/nike-logo.png">
                        <h1>Your Account For <br>Everything Nike</h1>
                        <form action="" class="myform" id="form">
                            <input type="email" id="email" class="input-box" placeholder="Your Email ID" required>
                            <input type="password" id="password" class="input-box" placeholder="Password" required>
                        </form>
                        <input type="checkbox" id="cheak"><span class="span-text">Keep me signed in</span>
                        <a href="forgot.html"><span class="span-text">Forgotten your password?</span></a>
                        <p class="text">By logging in, you agree to Nike's <u>Privacy Policy.</u> and <u>Terms of Use</u></p>
                        <button type="button" class="submit-btn" onclick="loginUser(event)">SIGN IN</button>
                        <p class="text1">Not a Member? <a href="join.html">Join Us</a></p>

                        <div id="error-message" style="color: red; display: none;"></div> <!-- Error message section -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Account Section -->
        <div id="delete-user-section">
            <h2>Delete Account</h2>
            <p>Warning: This action cannot be undone!</p>
            <button type="button" class="delete-btn" onclick="deleteUser(event)">Delete My Account</button>
        </div>

        <!-- footer started -->
        <div id="footer">
            <div class="fotter-div">
                <div class="fotter-text">
                    <a style="color:white; text-decoration:none;" href="findaStore.html">
                        <p>FIND A STORE</p>
                    </a>
                    <p>BECOME A MEMBER</p>
                    <p>SIGN UP FOR EMAIL</p>
                    <p>STUDENT DISCOUNTS</p>
                    <p>SEND US FEEDBACK</p>
                </div>
                <div class="fotter-text-1">
                    <p>GET HELP</p>
                    <p>Order Status</p>
                    <p>Delivery</p>
                    <p>Return</p>
                    <p>Payment Options</p>
                    <p>Contact Us on Nike.com Inquiries</p>
                    <p>Contact Us On All Other Inquiries</p>
                </div>
                <div class="fotter-text-1">
                    <p>ABOUT NIKE</p>
                    <p>News</p>
                    <p>Careers</p>
                    <p>Investors</p>
                    <p>Sustainability</p>
                </div>
                <div id="fotter-icon">
                    <div>
                        <a href="https://x.com/Nike" style="color: black; height: 25px;">
                        <ion-icon name="logo-twitter" style="margin-bottom: 20px;"></ion-icon>
                        </a>
                    </div>
                    <div>
                        <a href="https://www.facebook.com/nike/" style="color: black; height: 25px;">
                        <ion-icon name="logo-facebook" style="margin-bottom: 20px;"></ion-icon>
                        </a>
                    </div>
                    <div>
                        <a href="https://www.youtube.com/user/NIKE" style="color: black; height: 25px;">
                        <ion-icon name="logo-youtube" style="margin-bottom: 20px;"></ion-icon>
                        </a>
                    </div>
                    <div>
                        <a href="https://www.instagram.com/nike/" style="color: black; height: 25px;">
                        <ion-icon name="logo-instagram" style="margin-bottom: 20px;"></ion-icon>
                        </a>
                    </div>
                </div>
            </div>
            <hr id="footer-hr">
            <div id="copyright-section">
                <div>
                    <p id="india">
                        <ion-icon name="location-outline" id="location-icon"></ion-icon>India
                    </p>
                    <p>&copy 2024 Nike, inc. All Rights Reserved</p>
                </div>
                <div id="content-last">
                    <p>Guides</p>
                    <p>Terms of Sale</p>
                    <p>Terms of use</p>
                    <p>Nike Privacy Policy</p>
                </div>
            </div>
        </div>

        <script>
            function loginUser(e) {
                e.preventDefault();
                const email = document.getElementById("email").value;
                const password = document.getElementById("password").value;

                fetch('http://127.0.0.1:5002/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert("Login successful!");
                        window.location.href = "index.html";
                    } else {
                        document.getElementById("error-message").textContent = data.message;
                        document.getElementById("error-message").style.display = 'block';
                    }
                })
                .catch(error => alert("Error logging in. Please try again."));
            }

            function resetPassword(e) {
                e.preventDefault();
                const email = document.getElementById("forgot-email").value;

                fetch('http://127.0.0.1:5002/api/reset-password', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        document.getElementById("reset-message").textContent = "Reset link sent!";
                        document.getElementById("reset-message").style.display = 'block';
                    } else {
                        document.getElementById("reset-error-message").textContent = data.message;
                        document.getElementById("reset-error-message").style.display = 'block';
                    }
                })
                .catch(error => alert("Error resetting password. Try again."));
            }

            function deleteUser(e) {
    e.preventDefault();

    // Confirm deletion
    const confirmDelete = confirm("Are you sure you want to delete your account?");
    if (!confirmDelete) return;

    // Prompt for email and password
    const email = prompt("Enter the email of the account you want to delete:");
    if (!email) {
        alert("Email is required to delete the account.");
        return;
    }

    const password = prompt("Enter your password to confirm deletion:");
    if (!password) {
        alert("Password is required to delete the account.");
        return;
    }

    // Send DELETE request to the server with email and password
    fetch('http://127.0.0.1:5002/api/delete-user', {
        method: 'DELETE',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert("Account deleted successfully.");
            window.location.href = "index.html";  // Redirect to homepage
        } else {
            alert("Error: " + data.message);  // Display the error message
        }
    })
    .catch(error => {
        console.error("Error during account deletion:", error);
        alert("An error occurred. Please try again.");
    });
}

        </script>

    </div>
</body>
</html>
